\documentclass[11pt,a4paper]{ivoa}
\input tthdefs

\usepackage[utf8]{inputenc}
\usepackage{booktabs, tabulary}    % for nicer tables

\title{IVOA Provenance Data Model}

\ivoagroup{DM}

\author{Kristin Riebe}
\author{Mathieu Servillat}
\author{François Bonnarel}
\author{Mireille Louys}
\author{Florian Rothmaier}
\author{Michèle Sanguillon}
\author{IVOA Data Model Working Group}

\editor{Kristin Riebe}
\editor{Mathieu Servillat}

% \previousversion[????URL????]{????Funny Label????}
\previousversion[http://volute.g-vo.org/svn/trunk/projects/dm/provenance/description/ProvDM-0.2-20160428.pdf]{ProvDM-0.2-20160428.pdf}
\previousversion[http://volute.g-vo.org/svn/trunk/projects/dm/provenance/description/ProvDM-0.1-20141008.pdf]{ProvDM-0.1-20141008.pdf}


% own definitions
\definecolor{todocolor}{rgb}{1,1,0.8}
\definecolor{darkred}{rgb}{0.6,0,0}
\definecolor{rose}{rgb}{1.0,0.88,0.88}
\definecolor{darkgrey}{rgb}{0.35,0.35,0.35}
%\newcommand{\TODO}[1]{%
%    \noindent%
%    \textcolor{todocolor}{\sffamily [\textbf{TODO:} #1]}%
%}

\newcommand{\TODO}[1]{%
    \noindent%
    \colorbox{todocolor}{%
            \parbox{0.85\linewidth}{\sffamily \textbf{TODO:}\\
            #1}
    }%
    \vspace{2pt}

}

\newcommand{\Note}[1]{%
    \noindent%
    \textcolor{darkgrey}{{\sffamily Note:} \emph{#1}}%    
}


\newcommand{\paragraphlb}[1]{\paragraph{#1}\mbox{}\\} % paragraph with line break

\setlength{\fboxsep}{5pt}
%\setlength{\fboxrule}{1.5pt}
\newcommand{\warning}[1]{%
    \vspace{\baselineskip}
    \noindent
    \parbox{\linewidth}{%
        \colorbox{darkred}{%
            \parbox{0.7\linewidth}{\large \sffamily \textcolor{white}{Warning}}%
        }\\[-1pt]
        \noindent%
        \fcolorbox{darkred}{rose}{%
            \parbox{0.7\linewidth-2\fboxrule}{#1}%
        }%
    }%
    \vspace{\baselineskip}
}%

% for nicer tables:
\renewcommand{\arraystretch}{1.3}
\newcommand{\head}[1]{\textbf{#1}}


% define new command for classes, in case we decide later on for a different style
\newcommand{\class}[1]{\emph{#1}} 

\begin{document}
\newcolumntype{Y}{>{\raggedright\arraybackslash}X} 

\begin{abstract}
This draft is still an internal working draft, any comments welcome! 
The urls above also won't work yet, because this draft is only circulated 
via the volute-repository for now.

\warning{
    Everything described here is at a very 
    preliminary state and may change at any time!
}

\end{abstract}


\section*{Acknowledgments}

This document has been developed in part with support from the German
Astrophysical Virtual Observatory, funded by BMBF Bewilligungsnummer 05A08VHA.

Thanks for fruitful discussions to (in alphabetical order):
François Bonnarel, Markus Demleitner, Jochen Klar, Gerard Lemson, 
Mireille Louys and Adrian Partl.



\section*{Conformance-related definitions}

The words ``MUST'', ``SHALL'', ``SHOULD'', ``MAY'', ``RECOMMENDED'', and
``OPTIONAL'' (in upper or lower case) used in this document are to be
interpreted as described in IETF standard, \citet{std:RFC2119}.

The \emph{Virtual Observatory (VO)} is
a general term for a collection of federated resources that can be used
to conduct astronomical research, education, and outreach.
The \href{http://www.ivoa.net}{International
Virtual Observatory Alliance (IVOA)} is a global
collaboration of separately funded projects to develop standards and
infrastructure that enable VO applications.


\section{Introduction}
\input{intro-general}
\input{intro-requirements}
\input{intro-VOarchitecture}
\input{intro-previousefforts}

\section{The provenance data model}
\input{datamodel-description}
\input{datamodel-discussion}


\section{Applications/Interactions with other Data models}\label{sec:dmlinks}
In this section we discuss how the provenance data model interacts with
other VO data models (especially DatasetDM)
%(e.g. DatasetDM, SpectralDM (share some same classes), SimDM) 
and how provenance information can be stored.


\begin{figure}[h]
\centering
\includegraphics[width=\textwidth]{../datamodel-diagrams/classes-relations-dms}
\caption{Links between Agent and Party, Entity and Dataset.}
\label{fig:class-relations-dm}
\end{figure}

%\TODO{Put this in appendix? Or in datamodel-description? Or even in introduction?}

Table \ref{tab:datasetmapping} maps classes and attributes from the Dataset Data Model to concepts in the Provenance Data Model.

\begin{table}[h]
\small
\tymax  0.5\textwidth
\begin{tabulary}{1.0\textwidth}{@{}lLp{4cm}@{}}
\toprule
\head{Dataset DM} & \head{Provenance DM} & \head{Comment}\\
\midrule
DataID.title      & Entity.label               & title of the dataset\\
DataID.collection    & HadMember.collectionID  & link to the collection to which the dataset belongs\\
DataID.creator       & Agent.name          & name of agent\\ 
DataID.creatorDID    & AlternateOf.entityID     & id for the dataset given by the creator\\
DataID.ObservationID & wasGeneratedBy.activityID  & identifier to everything describing the observation; maybe it belongs to entity?\\
DataID.PublisherDID  & Entity.ID      & unique identifier for the dataset\\
Curation.PublisherID & Agent.ID  & link to the publisher; role: publisher, type: organization/astronomer private collection)\\
Curation.Publisher     & Agent.name & name of the publisher\\
Curation.Date          & Entity.releaseDate & release date of the dataset\\
Curation.Version       & Entity.version     & version of the dataset\\
Curation.Rights        & Entity.access      & access rights to the dataset; one of [...]\\
Curation.Reference     & Entity.link        & link to publication\\
Curation.Contact       & Agent.ID or name? & link to Agent with role contact\\
DataProductType  & EntityDescription & subclass to EntityDescription\\
DataProductSubType & EntityDescription & subclass to EntityDescription\\
CalibLevel       & EntityDescription & subclass to EntityDescription, calibration level\\\hline
\bottomrule
\end{tabulary}
\caption{Mapping between attributes from \class{Dataset}-classes from DatasetDM to classes in ProvenanceDM.}
\label{tab:datasetmapping}
\end{table}


\section{Accessing provenance information}
\input{provaccess}


\section{Use cases and implementations}\label{sec:usecases-implementations}
\input{usecases-implementations}


\appendix
\section{Changes from Previous Versions}
No official previous versions yet.
% No previous versions yet.
% these would be subsections "Changes from v. WD-..."
% Use itemize environments.


\bibliography{ivoatex/ivoabib,prov-refs}


\end{document}
