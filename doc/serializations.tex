\subsection{Introduction, serialization formats}
\label{sec:intro-serialization}
\input{serialisation-intro}

\subsection{Serialization of description classes in the data processing context}
\label{sec:description-serialization}

%{updated by Mathieu} 
%The ProvenanceDM includes description classes that can exist before any provenance information is recorded. 
Description classes in the Provenance DM gather informations on the data processing which can preexist to the processing itself.
First, the ActivityDescription class gives generic information on the activity (name, description, doculink...) and the parameters expected as an input. In addition, UsedDescription and WasGeneratedByDescription classes indicate the expected roles of the input and output entities respectively. Finally, The activity may expect specific kinds of entities as inputs or outputs, for which there may be detailed descriptions stored as EntityDescription records.

The serialization of an ActivityDescription, that includes all those description classes, is based on the IVOA DataLink Service Descriptors for service resources \citep{std:Datalink}, and can thus be stored as a VOTable  \citep{std:VOTABLE}. Indeed, a service descriptor points to a service that probably executes an activity using the given input parameters, some of which probably point to entities. One can thus easily translate an ActivityDescription VOTable to a DataLink service descriptor VOTable block, and vice-versa. 

The VOTable contains one resource with attributes type=``meta'' and utype=``voprov:ActivityDescription''. This resource contains PARAM elements to describe the activity and then GROUP elements gathering additional PARAM elements to describe:
\begin{itemize}
 \item the input parameters (group name=``InputParams''),
 \item the input entities (group name=``Used''),
 \item the output entities (group name=``Generated''). 
 \end{itemize} 
 
The standard PARAM elements for an activity resource correspond to the attributes of the ActivityDescription class (see Section~\ref{sec:activity}) and may include an Agent name and email. The utype attribute is used to connect the attribute to its location in the Provenance DM.
For the input parameters, each ParameterDescription attribute is mapped to a PARAM attribute (both have the same structure, see Section \ref{sec:parameters}).

For the input and output entity groups, each related entity is described with a GROUP block that contains several PARAM elements with those names:
\begin{itemize}
 \item[name="id"] for the default identifier of the entity (e.g. a file name),
 \item[name="role"] that gives the role of the Used or WasGeneratedBy relation (e.g. "red", "green" or "blue" channel image, or the output "RGB" file),
 \item[name="content\_type"] for the expected MIME type expected by the activity for the input or output entity,
 \item other additional PARAM elements corresponding to the EntityDescription attributes.
 \end{itemize} 

It is possible to reference an input parameter using the \emph{ref} attribute of PARAM, if an input entity is also given as an input parameter to the activity (e.g. the name of a file). In the following example the output file name "RGB.jpg" is given as a parameter to the activity and is thus referenced by the id PARAM element located in the GROUP of generated entities (with ref="RGB").

Here is an example of an ActivityDescription VOTable that describes an activity to create an RGB image from three red, green, blue images:


\begin{verbnobox}[\scriptsize]

<VOTABLE xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xmlns="http://www.ivoa.net/xml/VOTable/v1.3" version="1.3" 
    xsi:schemaLocation="http://www.ivoa.net/xml/VOTable/v1.3 
    http://www.ivoa.net/xml/VOTable/v1.3">
    
  <RESOURCE ID="make_RGB_image" name="make_RGB_image" 
      type="meta" utype="voprov:ActivityDescription">
      
    <DESCRIPTION>Create an RGB image from 3 images</DESCRIPTION>
    <LINK content-role="doc" href="..." />
    <PARAM name="name" datatype="char" arraysize="*" 
        value="make_RGB_image" utype="voprov:ActivityDescription.label" />
    <PARAM name="type" datatype="char" arraysize="*" 
        value="None" utype="voprov:ActivityDescription.type"/>
    <PARAM name="subtype" datatype="char" arraysize="*" 
        value="None" utype="voprov:ActivityDescription.subtype" />
    <PARAM name="version" datatype="float" 
        value="None" utype="voprov:ActivityDescription.version" />
    <PARAM name="contact_name" datatype="char" arraysize="*" 
        value="..." utype="voprov:Agent.name" />
    <PARAM name="contact_email" datatype="char" arraysize="*" 
        value="...@..." utype="voprov:Agent.email" />
        
    <GROUP name="InputParams" utype="voprov:Parameter">
      <PARAM ID="RGB" arraysize="*" datatype="char" name="RGB" 
          type="no_query" value="RGB.jpg">
        <DESCRIPTION>RGB image name</DESCRIPTION>
      </PARAM>
      <PARAM ID="order" arraysize="*" datatype="char" name="order" 
          type="no_query" value="RGB">
        <DESCRIPTION>order of the channels</DESCRIPTION>
        <VALUES>
          <OPTION value="RGB"/>
          <OPTION value="RBG"/>
          <OPTION value="GBR"/>
          <OPTION value="GRB"/>
          <OPTION value="BRG"/>
          <OPTION value="BGR"/>
        </VALUES>
      </PARAM>
    </GROUP>
    
    <GROUP name="Used" utype="voprov:Used">
      <GROUP name="R" utype="voprov:Entity">
        <DESCRIPTION>Image for red channel</DESCRIPTION>
        <PARAM arraysize="*" datatype="char" name="id" value="R.jpg" utype="voprov:Entity.id" />
        <PARAM arraysize="*" datatype="char" name="role" value="red" utype="voprov:Used.role" />
        <PARAM arraysize="*" datatype="char" name="content_type" value="image/jpeg" utype="voprov:EntityDescription.content_type" />
      </GROUP>
      <GROUP name="G" utype="voprov:Entity">
        <DESCRIPTION>Image for green channel</DESCRIPTION>
        <PARAM arraysize="*" datatype="char" name="id" value="G.jpg" utype="voprov:Entity.id" />
        <PARAM arraysize="*" datatype="char" name="role" value="green" utype="voprov:Used.role" />
        <PARAM arraysize="*" datatype="char" name="content_type" value="image/jpeg" utype="voprov:EntityDescription.content_type" />
      </GROUP>
      <GROUP name="B" utype="voprov:Entity">
        <DESCRIPTION>Image for blue channel</DESCRIPTION>
        <PARAM arraysize="*" datatype="char" name="id" value="B.jpg" utype="voprov:Entity.id" />
        <PARAM arraysize="*" datatype="char" name="role" value="blue" utype="voprov:Used.role" />
        <PARAM arraysize="*" datatype="char" name="content_type" value="image/jpeg" utype="voprov:EntityDescription.content_type" />
      </GROUP>
    </GROUP>
    
    <GROUP name="Generated" utype="voprov:WasGeneratedBy">
      <GROUP name="RGB" utype="voprov:Entity">
        <DESCRIPTION>RGB image generated</DESCRIPTION>
        <PARAM arraysize="*" datatype="char" name="id" value="RGB.jpg" ref="RGB" utype="voprov:Entity.id" />
        <PARAM arraysize="*" datatype="char" name="role" value="RGB" utype="voprov:WasGenereratedBy.role" />
        <PARAM arraysize="*" datatype="char" name="content_type" value="image/jpeg" utype="voprov:EntityDescription.content_type" />
      </GROUP>
      </PARAM>
    </GROUP>
    
  </RESOURCE>
</VOTABLE>

\end{verbnobox}

\input{serialization-w3c}